# Arc Coordination System - Knowledge Map

## Project Documentation

### Core Specifications
- `claude.md` - Main configuration and technical roadmap for the Arc Layer-1 coordination system
  - Architecture overview
  - Intent and AP2 design patterns
  - Atomic settlement implementation guide
  - Security and governance requirements

### External References
- Arc Network Docs: https://docs.arc.network/arc/tutorials/deploy-on-arc
- AP2 Protocol Specification: https://ap2-protocol.org/specification/
- CSA AP2 Security Guide: https://cloudsecurityalliance.org/blog/2025/10/06/secure-use-of-the-agent-payments-protocol-ap2

### Smart Contracts (contracts/src/)
- IntentRegistry.sol - On-chain intent hash and metadata storage
- AuctionEscrow.sol - Atomic escrow for matched intents with auction settlement
- PaymentRouter.sol - Stripe-based AP2 payment verification and routing

### Backend Services (services/)
- indexer.py - Arc blockchain event listener and intent indexer
- auction_engine.py - Auction-based matching engine with bid/ask logic
- ap2_gateway.py - Stripe API integration for payment credential verification
- api.py - FastAPI REST endpoints for intent submission and queries

### SDK and UI
- sdk/arc_sdk.py - Python SDK for intent lifecycle management
- ui/streamlit_app.py - Streamlit dashboard for all operations

### Testing and Deployment
- contracts/test/ - Foundry smart contract tests
- Deploy to Arc testnet using Foundry scripts

## Key Design Decisions
1. Atomic settlement only (no hybrid mode)
2. No zero-knowledge proofs (simplified privacy model)
3. Stripe test mode API for payment verification
4. Auction-based matching algorithm
5. Streamlit UI for user interactions

## Current Phase
✅ Phase 1 COMPLETED: Full system implementation

## Implementation Status

### Smart Contracts (100% Complete)
✅ IntentRegistry.sol - Intent hash storage with metadata
✅ AuctionEscrow.sol - Atomic escrow with auction settlement
✅ PaymentRouter.sol - Stripe payment verification and anchoring
✅ Complete test suite (27 tests passing)
✅ Deployment script for Arc network

### Backend Services (100% Complete)
✅ models.py - Pydantic data models
✅ indexer.py - Arc blockchain event indexer with SQLite
✅ auction_engine.py - Continuous double auction matching engine
✅ ap2_gateway.py - Stripe integration for AP2 payments
✅ api.py - FastAPI REST endpoints (15+ endpoints)

### Client Tools (100% Complete)
✅ arc_sdk.py - Comprehensive Python SDK
✅ streamlit_app.py - Full-featured web dashboard
✅ start.sh - Quick start script for all services

### Documentation (100% Complete)
✅ README.md - Complete usage guide
✅ .env.example - Configuration template
✅ Inline documentation in all files

## Quick Start

1. Configure environment:
   cp config/.env.example config/.env
   # Edit config/.env with your settings

2. Run quick start:
   ./start.sh

3. Access dashboard:
   http://localhost:8501

## Architecture Summary

On-Chain (Solidity):
- IntentRegistry: Intent metadata storage
- AuctionEscrow: Match escrow and settlement
- PaymentRouter: Payment verification oracle

Off-Chain (Python):
- Indexer: Event listening and database sync
- Auction Engine: Bid/ask matching with CDA
- AP2 Gateway: Stripe payment processing
- REST API: HTTP endpoints for all operations

Client:
- Python SDK: High-level API wrapper
- Streamlit UI: Interactive dashboard

## Test Results
All 27 smart contract tests passing:
- IntentRegistry: 8 tests
- AuctionEscrow: 6 tests
- PaymentRouter: 11 tests
- Counter (template): 2 tests
